"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[3248],{90867:(p,A,o)=>{o.r(A),o.d(A,{TransferAccountViewModel:()=>D});var h=o(10467),n=o(86739),g=o(23823),d=o(98669),f=o(92701);class D extends g.g{constructor(){super(...arguments),this.iSelAccType=0,this.ControlType=0,this._TargetAccountID=new d.y$(0),this._SelectedAccountType=new f.y$(0),this.TransferVisibility=!1,this.ChangeVisibility=!1,this.IsAssign=!1,this.IsContacts=!1,this.IsAdress=!1,this.IsNotes=!1,this.IsAttachments=!1,this.IsActivities=!1,this.IsControlAccounts=!1,this.dtTypes=null,this.dtTypesColumns=null}get TargetAccount(){return this._TargetAccountID}set TargetAccount(s){s!=this._TargetAccountID&&(this._TargetAccountID=s)}get AccountType(){return this._SelectedAccountType}set AccountType(s){s!=this._SelectedAccountType&&(this._SelectedAccountType=s)}TransferAccountViewModel(s,e,c){Logger.InfoLog("TransferAccountViewModel::Entering TransferAccountViewModel with AccountID="+s+",AccName="+e),this.lblText=n.d.GetResource("Acc_TransferData"),this.AccountID=s,this.SelectedAccount=e,this.TargetAccount.CCID=c,this.TransferVisibility=!0,this.AccountType.Label="Account Type",this.ChangeVisibility=!1,this.TargetAccount.CustomWhere="a.IsGroup=0",2==c?(this.lblName=n.d.GetResource("AccInfo_AccName"),this.lblTargetName=n.d.GetResource("Acc_TransferToAccount"),this.TargetAccount.TypeID=2):3==c?(this.lblName=n.d.GetResource("Prd_ProductName"),this.lblTargetName=n.d.GetResource("Prd_TransferToProduct"),this.TargetAccount.TypeID=10,this.TargetAccount.CustomWhere="a.IsGroup=0 and a.ProductTypeID=1"):50051==c?(this.lblName=n.d.GetResource("EmpMaster_EmpName"),this.lblTargetName=n.d.GetResource("EmpMaster_TransferToEmp"),this.TargetAccount.TypeID=1):(this.lblName=n.d.GetResource("CostCenter_Name"),this.lblTargetName=n.d.GetResource("Com_TransferToDimension"),this.TargetAccount.TypeID=1),this.TargetAccount.Label=this.lblTargetName,this.DisplayMessage="",this.MessageVisibility=!1,Logger.InfoLog("TransferAccountViewModel::Exiting TransferAccountViewModel")}LoadDataType(s){var e=this;return(0,h.A)(function*(){const{CostCenterPicker:i}=yield Promise.resolve().then(o.bind(o,56716));if(null==i.DSAccountTypes){let a=n.d.accounting.LoadDataType();i.DSAccountTypes=a.Tables[0],i.DSAccountTypesColumns=a.Columns[0]}let t=e.iSelAccType;e.dtTypes=i.DSAccountTypes.Copy(),e.dtTypesColumns=i.DSAccountTypesColumns.Copy(),n.d.SessionManager.Preferences.ContainsKey("IsControlAccounts")&&"TRUE"==n.d.SessionManager.Preferences.IsControlAccounts.toUpperCase()&&(e.IsControlAccounts=!0,0==e.ControlType&&(e.ControlType=1)),e.ControlType>0&&(2==e.ControlType?t=7:3==e.ControlType&&(t=6)),e.FillAccountTypes(e.AccountType,t)})()}FillAccountTypes(s,e){if(0==e&&(e=1),null!=s){let c=s.SelectedValue;if(s.Items.Clear(),this.IsControlAccounts){let i=[];1==this.ControlType?i=this.dtTypes.filter(t=>6==t.AccountTypeID||7==t.AccountTypeID):2==this.ControlType?(e=7,s.DefaultValue="7",i=this.dtTypes.filter(t=>7!=t.AccountTypeID)):3==this.ControlType&&(e=6,s.DefaultValue="6",i=this.dtTypes.filter(t=>6!=t.AccountTypeID)),i.forEach(t=>{this.dtTypes.Remove(t)})}this.dtTypes.forEach(i=>{let t=parseInt(i[this.dtTypesColumns[0]].toString());((4==e||8==e||11==e||5==e||9==e||12==e)&&(4==t||8==t||11==t||5==t||9==t||12==t)||(1==e||2==e||7==e||10==e||13==e||15==e||3==e||6==e||14==e||16==e)&&(1==t||2==t||7==t||10==t||13==t||15==e||3==t||6==t||14==t||16==e))&&s.Items.push(f._p.ComboBoxItems_2(i[this.dtTypesColumns[1]].toString(),i[this.dtTypesColumns[0]].toString()))}),s.SelectedValue=0!=e?e.toString():c}else s.SelectedValue=e.toString()}OnTransfer(s){var e=this;return(0,h.A)(function*(){const{ReportViewModel:c}=yield Promise.resolve().then(o.bind(o,35725)),{ReportViewComponent:i}=yield Promise.resolve().then(o.bind(o,73540));if(null!=s&&"Cancel"==s.toString())e.ParentObject instanceof c?n.d.page.HideDialog(e.PopUpGUID):2==e.TargetAccount.CCID?(e.Parent.TransferDataVisibility=!1,n.d.page.HideDialog(e.PopUpGUID)):3==e.TargetAccount.CCID?(e.ParentP.TransferDataVisibility=!1,e.ParentP.SetVisibilityFalse()):null!=e.ParentC?(e.ParentC.TransferDataVisibility=!1,e.ParentC.SetVisibilityFalse()):null!=e.ParentEM?(e.ParentEM.TransferDataVisibility=!1,e.ParentEM.SetVisibilityFalse()):null!=e.ParentObject&&"PACT.VIEWMODEL.ListOfCustomersViewModel"==e.ParentObject.toString()&&(e.ParentObject.TransferDataVisibility=!1,e.ParentObject.SetDetailsVisibile());else if(null!=s&&"Change"==s.toString()&&2==e.TargetAccount.CCID){let t=[];t.push(e.AccountID),t.push(e.AccountType.SelectedValue);let u=n.d.accounting.ChangeAccount(e.AccountID,e.AccountType.SelectedValue);e.DisplayMessage=u.RetValue>0?"Data changed Successfully":u.message,e.MessageVisibility=!0,e.Parent.Refresh()}else try{if(e.TargetAccount.SelectedValue<1||0==e.TargetAccount.SelectedValue)return e.DisplayMessage=n.d.GetResource("Select")+" "+n.d.GetResource("DocumentDesigner_Account"),void(e.MessageVisibility=!0);if(e.ParentObject instanceof c){let t=e.ParentObject,a="",u="";t.Filter.CostCenterFilters.forEach(T=>{T.CostCenterID>5e4&&(u=t.GetDimensionFilter(T.CostCenterID),u.length>0&&(a+=" and DCC.dcCCNID"+(T.CostCenterID-5e4)+" in ("+u+")"))}),null!=t.FromDatePicker&&null!=t.ToDatePicker&&(a+=" and D.DocDate BETWEEN CONVERT(FLOAT,CONVERT(DATETIME,'"+t.FromDatePicker.Date.ToString("dd MMM yyyy")+"')) AND CONVERT(FLOAT,CONVERT(DATETIME,'"+t.ToDatePicker.Date.ToString("dd MMM yyyy")+"'))");let r=[];r.push(e.AccountID),r.push(e.TargetAccount.SelectedValue),r.push(e.TargetAccount.CCID),r.push(e.IsAssign),r.push(e.IsContacts),r.push(e.IsAdress),r.push(e.IsNotes),r.push(e.IsAttachments),r.push(e.IsActivities),r.push(a);let l=n.d.accounting.TransferAccount(r);e.DisplayMessage=l.Message,e.MessageVisibility=!0,l.Message="",e.IsAssign&&(l.Message="Assign Data,"),e.IsContacts&&(l.Message+="Contacts,"),e.IsAdress&&(l.Message+="Address,"),e.IsNotes&&(l.Message+="Notes,"),e.IsAttachments&&(l.Message+="Attachments,"),e.IsActivities&&(l.Message+="Activities"),n.d.common.GetDataSet3("BULK005","TransferData","CostCenterID:"+e.TargetAccount.CCID+";TransforFrom:"+e.AccountID+";TransforTo:"+e.TargetAccount.SelectedValue+";SelectedTabs:"+l.Message+";TransferStatus:"+e.DisplayMessage,n.d.SessionManager.UserName)}else if(2==e.TargetAccount.CCID){let t;t="<XML>",t+='<Row ColID="2" Value="'+e.AccountID+'"/>',t+="</XML>";let a=new c;a.ReportViewModel_Document(95,t,297,!1,null,null),a.TransferData=e,e.ParentObject=a,n.d.page.HideDialog(e.PopUpGUID),n.d.page.addNewTab({component:i,params:{obj:a}})}else{let t=[];t.push(e.AccountID),t.push(e.TargetAccount.SelectedValue),t.push(e.TargetAccount.CCID),t.push(e.IsAssign),t.push(e.IsContacts),t.push(e.IsAdress),t.push(e.IsNotes),t.push(e.IsAttachments),t.push(e.IsActivities),t.push("");let a=n.d.accounting.TransferAccount(t);e.DisplayMessage=a.Message,e.MessageVisibility=!0}}catch(t){Logger.ErrorLog("TransferAccountViewModel:: OnTransfer"+t.stack)}})()}}}}]);