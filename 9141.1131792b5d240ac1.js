"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[9141],{21522:(g,p,o)=>{o.r(p),o.d(p,{Camera:()=>h,CameraWeb:()=>f});var s=o(10467),d=o(37464),u=o(91314);class f extends d.E_{getPhoto(e){var t=this;return(0,s.A)(function*(){return new Promise(function(){var r=(0,s.A)(function*(n,a){if(e.webUseInput||e.source===u.ru.Photos)t.fileInputExperience(e,n);else if(e.source===u.ru.Prompt){let i=document.querySelector("pwa-action-sheet");i||(i=document.createElement("pwa-action-sheet"),e.isMultiple?e.preview.appendChild(i):document.body.appendChild(i)),i.header=e.promptLabelHeader||"Photo",i.cancelable=!1,i.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],i.addEventListener("onSelection",function(){var l=(0,s.A)(function*(c){0===c.detail?t.fileInputExperience(e,n):e.isMultiple?t.multipleCameraExperience(e,n,a):t.cameraExperience(e,n,a)});return function(c){return l.apply(this,arguments)}}())}else e.isMultiple?t.multipleCameraExperience(e,n,a):t.cameraExperience(e,n,a)});return function(n,a){return r.apply(this,arguments)}}())})()}pickImages(e){var t=this;return(0,s.A)(function*(){return new Promise(function(){var r=(0,s.A)(function*(n){t.multipleFileInputExperience(n)});return function(n){return r.apply(this,arguments)}}())})()}cameraExperience(e,t,r){var n=this;return(0,s.A)(function*(){if(customElements.get("pwa-camera-modal")){const a=document.createElement("pwa-camera-modal");a.facingMode=e.direction===u.Jb.Front?"user":"environment",document.body.appendChild(a);try{yield a.componentOnReady(),a.addEventListener("onPhoto",function(){var i=(0,s.A)(function*(l){const c=l.detail;null===c?r(new d.I9("User cancelled photos app")):c instanceof Error?r(c):t(yield n._getCameraPhoto(c,e)),a.dismiss(),document.body.removeChild(a)});return function(l){return i.apply(this,arguments)}}()),a.present()}catch{n.fileInputExperience(e,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements."),n.fileInputExperience(e,t)})()}multipleCameraExperience(e,t,r){var n=this;return(0,s.A)(function*(){if(customElements.get("pwa-camera-modal")){const a=document.createElement("pwa-camera-modal");a.facingMode=e.direction===u.Jb.Front?"user":"environment",e.preview.appendChild(a);try{yield a.componentOnReady(),a.addEventListener("onPhoto",function(){var i=(0,s.A)(function*(l){const c=l.detail;if(null===c)r(new d.I9("User cancelled photos app")),a.dismiss(),e.preview.removeChild(a);else if(c instanceof Error)r(c),a.dismiss(),e.preview.removeChild(a);else{var m=yield n._getCameraPhoto(c,e);e.parent.OnImageSelect(m)}});return function(l){return i.apply(this,arguments)}}()),a.present(e.preview)}catch{n.fileInputExperience(e,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements."),n.fileInputExperience(e,t)})()}fileInputExperience(e,t){let r=document.querySelector("#_capacitor-camera-input");const n=()=>{var a;null===(a=r.parentNode)||void 0===a||a.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input",r.type="file",r.hidden=!0,document.body.appendChild(r),r.addEventListener("change",a=>{const i=r.files[0];let l="jpeg";if("image/png"===i.type?l="png":"image/gif"===i.type&&(l="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const c=new FileReader;c.addEventListener("load",()=>{if("dataUrl"===e.resultType)t({dataUrl:c.result,format:l});else if("base64"===e.resultType){const m=c.result.split(",")[1];t({base64String:m,format:l})}n()}),c.readAsDataURL(i)}else t({webPath:URL.createObjectURL(i),format:l}),n()})),r.accept="image/*",r.capture=!0,e.source===u.ru.Photos||e.source===u.ru.Prompt?r.removeAttribute("capture"):e.direction===u.Jb.Front?r.capture="user":e.direction===u.Jb.Rear&&(r.capture="environment"),r.click()}multipleFileInputExperience(e){let t=document.querySelector("#_capacitor-camera-input-multiple");t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",n=>{const a=[];for(let i=0;i<t.files.length;i++){const l=t.files[i];let c="jpeg";"image/png"===l.type?c="png":"image/gif"===l.type&&(c="gif"),a.push({webPath:URL.createObjectURL(l),format:c})}e({photos:a}),(()=>{var n;null===(n=t.parentNode)||void 0===n||n.removeChild(t)})()})),t.accept="image/*",t.click()}_getCameraPhoto(e,t){return new Promise((r,n)=>{const a=new FileReader,i=e.type.split("/")[1];"uri"===t.resultType?r({webPath:URL.createObjectURL(e),format:i,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const l=a.result;r("dataUrl"===t.resultType?{dataUrl:l,format:i,saved:!1}:{base64String:l.split(",")[1],format:i,saved:!1})},a.onerror=l=>{n(l)})})}checkPermissions(){var e=this;return(0,s.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw e.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw e.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var e=this;return(0,s.A)(function*(){throw e.unimplemented("Not implemented on web.")})()}}const h=new f}}]);