"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[4130],{81749:(g,n,a)=>{a.r(n),a.d(n,{TempProductInfoViewModel:()=>S});var h=a(10467),u=a(23823),P=a(31820),i=a(86739),r=a(8787),l=a(32647);class S extends u.g{constructor(t){if(super(),this.PruchasePrice=new P.Dw(0),this.PartName=new P.Dw(0),this.Parent=null,Logger.InfoLog("TempProductInfoViewModel:: Entering TempProductInfoViewModel"),this.Parent=t,"AddEditDocumentViewModel"==this.Parent.className){let e=i.d.admin.GetDocTempProductInfo(this.Parent.DocumentID);null!=e&&e.Tables.length>0&&e.Tables[0].forEach(s=>{"ProductCode"==r.J0.String(s.SysColumnName)?(this.PartName.Visible=(0,l.yG0)(r.J0.String(s.IsVisible)),this.PartName.Visible&&(this.PartName.IsReadOnly=!(0,l.yG0)(r.J0.String(s.IsEditable)),"2"==r.J0.String(s.TextFormat)&&(this.PartName.IsAllCaps=!0),"3"==r.J0.String(s.TextFormat)&&(this.PartName.IsFirstLetterCaps=!0),this.PartName.Mandatory=(0,l.yG0)(r.J0.String(s.IsMandatory)),this.PartName.Row=s.RowNo,this.PartName.Column=s.ColumnNo,this.PartName.Label=s.UserColumnName)):"PurchasePrice"==r.J0.String(s.SysColumnName)&&(this.PruchasePrice.Visible=(0,l.yG0)(r.J0.String(s.IsVisible)),this.PruchasePrice.Visible&&(this.PruchasePrice.IsReadOnly=!(0,l.yG0)(r.J0.String(s.IsEditable)),this.PruchasePrice.Mandatory=(0,l.yG0)(s.IsMandatory),this.PruchasePrice.Row=s.RowNo,this.PruchasePrice.Column=s.ColumnNo,this.PruchasePrice.Label=s.UserColumnName))})}else this.PruchasePrice.Row=1,this.PruchasePrice.Column=1,this.PruchasePrice.Label="Pruchase Price",this.PartName.Label="Part No.";if("AddEditDocumentViewModel"==this.Parent.className?this.Title="Temp Product Info":"TempPartProductViewModel"==this.Parent.className&&(this.Title="Product Info"),"AddEditDocumentViewModel"==this.Parent.className&&null!=this.Parent.SelectedRow&&null!=this.Parent.SelectedRow&&""!=r.J0.String(this.Parent.SelectedRow.ExtraXML)){let e=new r.VB;e.LoadXml(this.Parent.SelectedRow.ExtraXML);let s=e.SelectSingleNode("xml/Row");""!=r.J0.String(s.attributes.ProductCode.value)&&(this.PartName.Text=s.attributes.ProductCode.Value.toString()),this.PruchasePrice.Text=s.attributes.PurchasePrice.value}else"TempPartProductViewModel"==this.Parent.className&&null!=this.Parent.SelectedRow&&(this.PruchasePrice.IsReadOnly=!0,this.PartName.IsReadOnly=!0,this.PartName.Text=r.J0.String(this.Parent.SelectedRow.NewPartNo_Key),this.PruchasePrice.Text=r.J0.String(this.Parent.SelectedRow.PurchasePrice),this.DisplayMessage=""!=r.J0.String(this.Parent.SelectedRow.Product_Key)?this.Parent.SelectedRow.Product+" will be assinged to "+this.Parent.SelectedRow.DocNo+" and linked vouchers":this.Parent.SelectedRow.NewPartNo_Key+" will be created and assinged to "+this.Parent.SelectedRow.DocNo+" and linked vouchers");Logger.InfoLog("TempProductInfoViewModel:: Entering TempProductInfoViewModel")}OnButtonClick(t){"Cancel"==t?i.d.page.HideDialog(this.PopUpGUID):"OK"==t&&("AddEditDocumentViewModel"==this.Parent?this.AddInfo():"TempPartProductViewModel"==this.Parent&&this.CreateProduct(),i.d.page.HideDialog(this.PopUpGUID))}CreateProduct(){var t=this;return(0,h.A)(function*(){let e=[];""!=r.J0.String(t.Parent.SelectedRow.Product_Key)?e.push(t.Parent.SelectedRow.Product_Key.toString()):e.push(0),""!=r.J0.String(t.Parent.SelectedRow.CategoryID_Key)?e.push(t.Parent.SelectedRow.CategoryID_Key):e.push("1");let s="";""!=r.J0.String(t.Parent.SelectedRow.Billable)&&(s+="ptAlpha1=N'"+t.Parent.SelectedRow.Billable.toString()+"',"),e.push(s);let c="";""!=r.J0.String(t.Parent.SelectedRow.CategoryID_Key)&&(c+=" CCNID6="+t.Parent.SelectedRow.CategoryID_Key.toString()+","),e.push(c),""!=r.J0.String(t.Parent.SelectedRow.PurchasePrice)?e.push(t.Parent.SelectedRow.PurchasePrice.toString()):e.push("0"),""!=r.J0.String(t.Parent.SelectedRow.SellingPrice)?e.push(t.Parent.SelectedRow.SellingPrice.toString()):e.push("0"),e.push(t.Parent.SelectedRow.NewPartNo_Key.toString()),e.push(t.Parent.SelectedRow.INVDOCDETAILSID.toString()),e.push(i.d.SessionManager.CompanyGUID),e.push(i.d.SessionManager.UserName),e.push(i.d.SessionManager.UserID),e.push(i.d.SessionManager.LanguageID);let o=0,d=yield i.d.admin.CreateTempProduct(e);t.Parent.DisplayMessage=d.Message,o=d.RetVal,t.Parent.MessageVisibility=!0,o>0&&(t.Parent.SelectedRow.ProductID=o,t.Parent.SelectedRow.Create="View Product")})()}AddInfo(){this.PruchasePrice.DataType="FLOAT";let t=this.PruchasePrice.ValidateData();if(""!=t)return this.DisplayMessage=t,void(this.MessageVisibility=!0);if(null!=this.Parent.SelectedRow&&this.Parent.SelectedRow){let e="";e+="<xml><Row ",e+='ProductCode="'+this.PartName.Text+'" ',e+=null!=this.PruchasePrice.Text?'PurchasePrice="'+this.PruchasePrice.Text.Replace(",","")+'" ':'PurchasePrice="0" ',e+=" ></Row></xml>",this.Parent.SelectedRow.ExtraXML=e.toString()}}}}}]);